# 在同一台电脑上运行多个客户端实例

## 问题分析

经过代码分析，服务器端是支持同一IP地址的多个客户端连接的，只要每个客户端使用不同的用户名即可。问题可能出在IDE的QT插件限制上，导致无法在同一IDE环境中启动多个客户端实例。

## 解决方案

### 1. 使用启动脚本（推荐）

我已经创建了一个启动脚本 `start_multiple_clients.py`，可以帮助你在同一台电脑上启动多个客户端实例。

**使用方法：**
1. 确保服务器已经启动
2. 在命令行中运行：
   ```bash
   python start_multiple_clients.py
   ```
3. 脚本会自动启动2个客户端实例，你可以在脚本中修改 `CLIENT_COUNT` 变量来调整数量
4. 为每个客户端输入不同的用户名即可

### 2. 手动启动多个实例

你也可以手动在不同的命令行窗口中启动客户端：

1. 打开第一个命令行窗口，运行：
   ```bash
   python client_tcp.py
   ```

2. 打开第二个命令行窗口，运行：
   ```bash
   python client_tcp.py
   ```

3. 为每个客户端输入不同的用户名

### 3. 修改客户端端口（可选）

如果仍然遇到问题，你可以尝试修改客户端代码，让每个客户端使用不同的本地端口。

1. 复制 `client_tcp.py` 为 `client_tcp_2.py`
2. 修改 `client_tcp_2.py` 中的 socket 创建部分，添加本地端口绑定：

```python
def connect_to_server(self):
    """连接到服务器"""
    try:
        # 创建socket连接
        self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        # 绑定到不同的本地端口
        self.socket.bind(('127.0.0.1', 0))  # 使用随机端口
        # 只在连接阶段设置超时
        self.socket.settimeout(5)
        try:
            self.socket.connect((self.host, self.port))
        finally:
            # 连接成功后移除超时设置，保持长连接
            self.socket.settimeout(None)
        
        # ... 其余代码不变
```

## 注意事项

1. 确保每个客户端使用**不同的用户名**
2. 如果使用云服务器，确保服务器防火墙允许你的IP地址连接
3. 如果遇到连接问题，检查服务器是否正在运行
4. 避免同时启动太多客户端实例，以免影响性能

## 测试建议

1. 先启动服务器
2. 启动两个客户端实例，使用不同的用户名
3. 在第一个客户端中点击第二个客户端的用户名，进入私聊界面
4. 发送消息测试私聊功能
5. 返回公共聊天室，测试公开消息功能

## 常见问题

**Q: 为什么第二个客户端连接失败？**
A: 请检查是否使用了相同的用户名，服务器不允许重复用户名。

**Q: 为什么客户端无法连接到服务器？**
A: 请检查服务器是否正在运行，以及网络连接是否正常。

**Q: 为什么私聊消息没有显示？**
A: 请确保你已经正确进入了私聊界面，并且对方在线。
